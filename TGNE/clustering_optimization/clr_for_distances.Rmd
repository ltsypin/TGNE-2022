---
title: "clr_for_distances"
author: "Michael Bertagna"
date: "2024-02-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
setwd("~/git/TGNE-2022/TGNE/clustering_optimization")
library(parmigene)
library(Rgraphviz)
library(igraph)
library(reshape2)
library(parallel)
library(bigmemory)
library(snow)
detectCores()
Sys.getenv("OMP_NUM_THREADS")
```

```{r}
for (nn in 2:12) {
  data <- read.csv("../microarray_probe_alignment_and_filtering/allgood_filt_agg_tidy_2021aligned_qc_rma_expression_full.csv", header = TRUE, row.names = 1)
  
  data_knn <- knnmi.all(data, k = nn)
  
  rm(data)
  
  clr_network <- clr(data_knn)
  
  rm(data_knn)
  
  write.csv(as.data.frame(clr_network), file = paste('./clr_network_for_distances_', nn, '.csv', sep = ''), row.names = TRUE)
  
  rm(clr_network)
  
  gc()
}
```
